(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(o){if(o.ep)return;o.ep=!0;const s=t(o);fetch(o.href,s)}})();class y{constructor(){this.folders=[],this.notes=[],this.settings={},this.currentFolderId=null,this.isDragging=!1,this.currentDragNote=null,this.dragOffset={x:0,y:0},this.init()}async init(){await this.loadData(),this.setupEventListeners(),this.updateClock(),this.updateGreeting(),this.renderFolders(),this.renderNotes(),this.loadWallpaper(),this.loadQuote(),setInterval(()=>this.updateClock(),1e3),setInterval(()=>this.updateGreeting(),6e4),setInterval(()=>this.loadWallpaper(),36e5)}async loadData(){try{const e=await this.getStorageData();this.folders=e.folders||[{id:"f1",name:"Pekerjaan",todos:[],expanded:!1},{id:"f2",name:"Pribadi",todos:[],expanded:!1},{id:"f3",name:"Belajar",todos:[],expanded:!1}],this.notes=e.notes||[],this.settings=e.settings||{userName:"User",theme:"auto"}}catch(e){console.error("Error loading data:",e),this.folders=[{id:"f1",name:"Pekerjaan",todos:[],expanded:!1},{id:"f2",name:"Pribadi",todos:[],expanded:!1},{id:"f3",name:"Belajar",todos:[],expanded:!1}],this.notes=[],this.settings={userName:"User",theme:"auto"}}}async saveData(){try{await this.setStorageData({folders:this.folders,notes:this.notes,settings:this.settings})}catch(e){console.error("Error saving data:",e)}}getStorageData(){return new Promise(e=>{if(typeof chrome<"u"&&chrome.storage&&chrome.storage.local)chrome.storage.local.get(["folders","notes","settings"],t=>{e(t)});else{const t=localStorage.getItem("zendash_folders"),n=localStorage.getItem("zendash_notes"),o=localStorage.getItem("zendash_settings");e({folders:t?JSON.parse(t):null,notes:n?JSON.parse(n):null,settings:o?JSON.parse(o):null})}})}setStorageData(e){return new Promise(t=>{typeof chrome<"u"&&chrome.storage&&chrome.storage.local?chrome.storage.local.set(e,()=>{t()}):(e.folders&&localStorage.setItem("zendash_folders",JSON.stringify(e.folders)),e.notes&&localStorage.setItem("zendash_notes",JSON.stringify(e.notes)),e.settings&&localStorage.setItem("zendash_settings",JSON.stringify(e.settings)),t())})}updateClock(){const e=new Date,t=e.getHours().toString().padStart(2,"0"),n=e.getMinutes().toString().padStart(2,"0"),o=e.getSeconds().toString().padStart(2,"0"),s=document.getElementById("clock");s&&(s.textContent=`${t}:${n}:${o}`)}updateGreeting(){const e=new Date().getHours(),t=this.settings.userName||"User";let n="Selamat ";e<10?n+="Pagi":e<15?n+="Siang":e<18?n+="Sore":n+="Malam",n+=`, ${t}`;const o=document.getElementById("greeting");o&&(o.textContent=n)}async loadWallpaper(){try{const e=new Date().getHours(),o=`https://picsum.photos/seed/${`zendash-${new Date().getDate()}-${e}`}/1920/1080?grayscale&blur=2`,s=new Image;s.onload=()=>{const a=document.getElementById("wallpaper");a&&(a.style.backgroundImage=`url(${o})`,console.log("Wallpaper loaded from Picsum"))},s.onerror=()=>{throw new Error("Picsum failed")},s.src=o}catch(e){console.log("Wallpaper fetch failed, using gradient fallback:",e),this.setGradientFallback()}}setGradientFallback(){const e=["linear-gradient(135deg, #1e3c72 0%, #2a5298 50%, #7e8ba3 100%)","linear-gradient(135deg, #134e5e 0%, #71b280 100%)","linear-gradient(135deg, #232526 0%, #414345 100%)","linear-gradient(135deg, #8b0000 0%, #dc143c 50%, #ff6b6b 100%)","linear-gradient(135deg, #2c3e50 0%, #3498db 100%)","linear-gradient(135deg, #1a237e 0%, #3949ab 50%, #5e35b1 100%)","linear-gradient(135deg, #263238 0%, #37474f 50%, #455a64 100%)","linear-gradient(135deg, #3e2723 0%, #5d4037 50%, #8d6e63 100%)"],t=e[Math.floor(Math.random()*e.length)],n=document.getElementById("wallpaper");n&&(n.style.background=t)}async loadQuote(){try{const e=await fetch("https://dummyjson.com/quotes/random");if(e.ok){const t=await e.json();this.updateQuote(t.quote,t.author);return}throw new Error("Quote API failed")}catch(e){console.log("Quote API failed, using local fallback:",e);const t=[{text:"Kesuksesan adalah kemampuan untuk bangkit kembali dari kegagalan.",author:"Winston Churchill"},{text:"Jangan menunggu kesempurnaan. Mulai dengan apa yang Anda miliki.",author:"Anonymous"},{text:"Kegagalan adalah bumbu yang membuat kesuksesan terasa lebih manis.",author:"Anonymous"},{text:"Hari ini adalah hadiah, itulah mengapa disebut sebagai masa kini.",author:"Eleanor Roosevelt"},{text:"Satu langkah kecil setiap hari akan membawa Anda ke tempat yang Anda inginkan.",author:"Anonymous"}],n=t[Math.floor(Math.random()*t.length)];this.updateQuote(n.text,n.author)}}updateQuote(e,t){const n=document.getElementById("quote-text"),o=document.getElementById("quote-author");n&&(n.textContent=`"${e}"`,n.classList.add("animate-slide-up")),o&&(o.textContent=`â€” ${t}`)}renderFolders(){const e=document.getElementById("folders-container");e&&(e.innerHTML="",this.folders.forEach(t=>{const n=this.createFolderElement(t);e.appendChild(n)}))}createFolderElement(e){const t=document.createElement("div");t.className="folder-item mb-2";const n=document.createElement("div");n.className="glass rounded-lg p-3 cursor-pointer flex items-center justify-between",n.innerHTML=`
            <div class="flex items-center">
                <svg class="w-4 h-4 mr-2 transition-transform ${e.expanded?"rotate-90":""}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
                <span class="font-medium">${e.name}</span>
                <span class="ml-2 text-sm opacity-70">(${e.todos.filter(s=>!s.completed).length}/${e.todos.length})</span>
            </div>
            <div class="flex space-x-2">
                <button class="add-todo-btn p-1 hover:bg-white hover:bg-opacity-20 rounded" data-folder-id="${e.id}">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                    </svg>
                </button>
                <button class="delete-folder-btn p-1 hover:bg-white hover:bg-opacity-20 rounded" data-folder-id="${e.id}">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                    </svg>
                </button>
            </div>
        `;const o=document.createElement("div");return o.className=`mt-2 space-y-1 ${e.expanded?"block":"hidden"}`,e.todos.forEach(s=>{const a=this.createTodoElement(e.id,s);o.appendChild(a)}),n.addEventListener("click",s=>{s.target.closest("button")||(e.expanded=!e.expanded,this.saveData(),this.renderFolders())}),t.appendChild(n),t.appendChild(o),t}createTodoElement(e,t){const n=document.createElement("div");return n.className="todo-item flex items-center p-2 glass rounded",n.innerHTML=`
            <input type="checkbox" class="mr-3" ${t.completed?"checked":""} data-folder-id="${e}" data-todo-id="${t.id}">
            <span class="${t.completed?"line-through opacity-60":""}">${t.text}</span>
            <button class="ml-auto delete-todo-btn p-1 hover:bg-white hover:bg-opacity-20 rounded" data-folder-id="${e}" data-todo-id="${t.id}">
                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
        `,n}renderNotes(){const e=document.getElementById("notes-grid");e&&(e.innerHTML="",this.notes.forEach(t=>{const n=this.createNoteElement(t);e.appendChild(n)}))}createNoteElement(e){const t=document.createElement("div");t.className="sticky-note relative bg-yellow-200 p-3 rounded-lg shadow-lg cursor-move w-48 min-h-[120px] transition-transform hover:scale-105",t.dataset.noteId=e.id;const n=document.createElement("div");n.className="flex justify-between items-start mb-2";const o=document.createElement("div");o.className="font-semibold text-gray-800 text-sm flex-1",o.textContent=e.title||"Note";const s=document.createElement("button");s.className="text-red-500 hover:text-red-700 text-xs ml-1",s.innerHTML="Ã—",s.addEventListener("click",r=>{r.stopPropagation(),this.deleteNote(e.id)}),n.appendChild(o),n.appendChild(s);const a=document.createElement("div");return a.className="text-gray-700 text-sm whitespace-pre-wrap break-words",a.textContent=e.content,t.appendChild(n),t.appendChild(a),t.addEventListener("mousedown",r=>this.startDrag(r,e.id)),t}startDrag(e,t){if(e.target.tagName==="BUTTON"||(this.isDragging=!0,this.currentDragNote=t,!this.notes.find(r=>r.id===t)))return;const o=e.currentTarget,s=o.getBoundingClientRect();this.dragOffset.x=e.clientX-s.left,this.dragOffset.y=e.clientY-s.top;const a=o.cloneNode(!0);a.id="dragging-clone",a.className=a.className.replace("relative","fixed")+" opacity-75 z-50 pointer-events-none",a.style.left=e.clientX-this.dragOffset.x+"px",a.style.top=e.clientY-this.dragOffset.y+"px",a.style.width=s.width+"px",document.body.appendChild(a),o.style.opacity="0.3",document.addEventListener("mousemove",this.handleDrag),document.addEventListener("mouseup",this.stopDrag),e.preventDefault()}handleDrag=e=>{if(!this.isDragging)return;const t=document.getElementById("dragging-clone");t&&(t.style.left=e.clientX-this.dragOffset.x+"px",t.style.top=e.clientY-this.dragOffset.y+"px")};stopDrag=()=>{if(!this.isDragging)return;this.isDragging=!1;const e=document.getElementById("dragging-clone");e&&e.remove(),document.querySelectorAll(".sticky-note").forEach(t=>{t.style.opacity=""}),document.removeEventListener("mousemove",this.handleDrag),document.removeEventListener("mouseup",this.stopDrag)};setupEventListeners(){const e=document.getElementById("refresh-quote");e&&e.addEventListener("click",()=>this.loadQuote());const t=document.getElementById("add-folder");t&&t.addEventListener("click",()=>this.showFolderModal());const n=document.getElementById("save-folder"),o=document.getElementById("cancel-folder");document.getElementById("folder-modal"),n&&n.addEventListener("click",()=>this.saveFolder()),o&&o.addEventListener("click",()=>this.hideFolderModal());const s=document.getElementById("save-todo"),a=document.getElementById("cancel-todo");s&&s.addEventListener("click",()=>this.saveTodo()),a&&a.addEventListener("click",()=>this.hideTodoModal());const r=document.getElementById("notes-toggle"),l=document.getElementById("notes-panel"),c=document.getElementById("notes-toggle-text"),m=document.getElementById("add-note");r&&l&&c&&r.addEventListener("click",()=>{l.classList.contains("hidden")?(l.classList.remove("hidden"),c.textContent="ðŸ“ Hide Notes"):(l.classList.add("hidden"),c.textContent="ðŸ“ Show Notes")}),m&&m.addEventListener("click",()=>this.showNoteModal());const u=document.getElementById("save-note"),h=document.getElementById("cancel-note");u&&u.addEventListener("click",()=>this.saveNote()),h&&h.addEventListener("click",()=>this.hideNoteModal()),document.addEventListener("click",d=>{const i=d.target.closest('.add-todo-btn, .delete-folder-btn, .delete-todo-btn, input[type="checkbox"]');i&&i.matches(".add-todo-btn")?(d.preventDefault(),this.currentFolderId=i.dataset.folderId,console.log("Add todo clicked for folder:",this.currentFolderId),this.showTodoModal()):i&&i.matches(".delete-folder-btn")?(d.preventDefault(),this.deleteFolder(i.dataset.folderId)):i&&i.matches(".delete-todo-btn")?(d.preventDefault(),this.deleteTodo(i.dataset.folderId,i.dataset.todoId)):i&&i.matches('input[type="checkbox"]')&&(d.preventDefault(),this.toggleTodo(i.dataset.folderId,i.dataset.todoId))});const g=document.getElementById("folder-name"),f=document.getElementById("todo-text");document.getElementById("note-title");const p=document.getElementById("note-content");g&&g.addEventListener("keypress",d=>{d.key==="Enter"&&this.saveFolder()}),f&&f.addEventListener("keypress",d=>{d.key==="Enter"&&this.saveTodo()}),p&&p.addEventListener("keypress",d=>{d.key==="Enter"&&!d.shiftKey&&(d.preventDefault(),this.saveNote())})}showFolderModal(){const e=document.getElementById("folder-modal"),t=document.getElementById("folder-name");e&&t&&(e.classList.remove("hidden"),t.value="",t.focus())}hideFolderModal(){const e=document.getElementById("folder-modal");e&&e.classList.add("hidden")}showTodoModal(){const e=document.getElementById("todo-modal"),t=document.getElementById("todo-text");e&&t&&(e.classList.remove("hidden"),t.value="",t.focus())}hideTodoModal(){const e=document.getElementById("todo-modal");e&&e.classList.add("hidden"),this.currentFolderId=null}async saveFolder(){const e=document.getElementById("folder-name");if(!e||!e.value.trim())return;const t={id:"f"+Date.now(),name:e.value.trim(),todos:[],expanded:!1};this.folders.push(t),await this.saveData(),this.renderFolders(),this.hideFolderModal()}async saveTodo(){const e=document.getElementById("todo-text");if(!e||!e.value.trim()||!this.currentFolderId){console.warn("Cannot save todo: missing input, folder ID, or empty text");return}const t=this.folders.find(o=>o.id===this.currentFolderId);if(!t){console.warn("Cannot save todo: folder not found with ID",this.currentFolderId);return}const n={id:"t"+Date.now(),text:e.value.trim(),completed:!1};t.todos.push(n),await this.saveData(),this.renderFolders(),this.hideTodoModal(),t.expanded=!0,await this.saveData(),this.renderFolders()}async deleteFolder(e){confirm("Apakah Anda yakin ingin menghapus folder ini?")&&(this.folders=this.folders.filter(t=>t.id!==e),await this.saveData(),this.renderFolders())}async deleteTodo(e,t){const n=this.folders.find(o=>o.id===e);n&&(n.todos=n.todos.filter(o=>o.id!==t),await this.saveData(),this.renderFolders())}async toggleTodo(e,t){const n=this.folders.find(s=>s.id===e);if(!n)return;const o=n.todos.find(s=>s.id===t);o&&(o.completed=!o.completed,await this.saveData(),this.renderFolders())}showNoteModal(){const e=document.getElementById("note-modal"),t=document.getElementById("note-title"),n=document.getElementById("note-content");e&&t&&n&&(e.classList.remove("hidden"),t.value="",n.value="",n.focus())}hideNoteModal(){const e=document.getElementById("note-modal");e&&e.classList.add("hidden")}async saveNote(){const e=document.getElementById("note-title"),t=document.getElementById("note-content");if(!t||!t.value.trim()){console.warn("Cannot save note: missing content or empty");return}const n={id:"n"+Date.now(),title:e?e.value.trim():"",content:t.value.trim(),createdAt:new Date().toISOString()};this.notes.push(n),await this.saveData(),this.renderNotes(),this.hideNoteModal();const o=document.getElementById("notes-panel"),s=document.getElementById("notes-toggle-text");o&&o.classList.contains("hidden")&&(o.classList.remove("hidden"),s&&(s.textContent="ðŸ“ Hide Notes"))}async deleteNote(e){confirm("Apakah Anda yakin ingin menghapus catatan ini?")&&(this.notes=this.notes.filter(t=>t.id!==e),await this.saveData(),this.renderNotes())}}document.addEventListener("DOMContentLoaded",()=>{new y});
